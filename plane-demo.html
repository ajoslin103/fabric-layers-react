<!DOCTYPE html>
<html>
<head>
    <title>Fabric Layers React Demo</title>
    <style>
        .canvas-container {
            margin: 20px;
            border: 1px solid #ccc;
        }
        .controls {
            margin: 20px;
        }
        button {
            margin-right: 10px;
            padding: 8px 16px;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <!-- Load React -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- Load Fabric.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/5.3.1/fabric.min.js"></script>

    <!-- Load Babel for JSX support -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Our component -->
    <script type="text/babel">
        // Simple demo component using plain Fabric.js without layers
        function Demo() {
            const canvasRef = React.useRef(null);
            const [activeLayer, setActiveLayer] = React.useState(0);

            const addRectangle = () => {
                if (canvasRef.current) {
                    const rect = new fabric.Rect({
                        left: 100,
                        top: 100,
                        width: 50,
                        height: 50,
                        fill: 'red'
                    });
                    canvasRef.current.add(rect);
                    canvasRef.current.renderAll();
                }
            };

            const addCircle = () => {
                if (canvasRef.current) {
                    const circle = new fabric.Circle({
                        left: 200,
                        top: 100,
                        radius: 30,
                        fill: 'blue'
                    });
                    canvasRef.current.add(circle);
                    canvasRef.current.renderAll();
                }
            };

            const clearCanvas = () => {
                if (canvasRef.current) {
                    canvasRef.current.clear();
                }
            };

            React.useEffect(() => {
                // Initialize canvas
                const canvas = new fabric.Canvas('canvas', {
                    width: 600,
                    height: 400,
                    backgroundColor: '#f0f0f0'
                });
                
                // Store reference
                canvasRef.current = canvas;

                return () => {
                    canvas.dispose();
                };
            }, []);

            return (
                <div>
                    <div className="controls">
                        <button onClick={addRectangle}>Add Rectangle</button>
                        <button onClick={addCircle}>Add Circle</button>
                        <button onClick={clearCanvas}>Clear Canvas</button>
                    </div>
                    <canvas id="canvas"></canvas>
                </div>
            );
        }

        // Render the app
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<Demo />);
    </script>
</body>
</html>